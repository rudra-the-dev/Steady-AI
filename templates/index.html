<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üí¨ AI Chat Assistant</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background-color: #F8F5F0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }

        .header {
            background-color: #fff;
            padding: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 100;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .header-left h1 {
            color: #2D3E33;
            font-size: 24px;
            margin-bottom: 5px;
        }

        .header-left p {
            color: #666;
            font-size: 14px;
        }

        .menu-btn {
            background-color: #fff;
            border: 2px solid #E9E1D3;
            border-radius: 8px;
            padding: 10px 15px;
            cursor: pointer;
            font-size: 18px;
            transition: all 0.2s;
        }

        .menu-btn:hover {
            background-color: #F8F5F0;
            border-color: #4A5D50;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            top: 0;
            right: -300px;
            width: 300px;
            height: 100vh;
            background: white;
            box-shadow: -2px 0 10px rgba(0,0,0,0.1);
            transition: right 0.3s ease;
            z-index: 1000;
            padding: 20px;
        }

        .sidebar.open {
            right: 0;
        }

        .sidebar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }

        .sidebar-header h2 {
            color: #2D3E33;
            font-size: 20px;
        }

        .close-btn {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #666;
        }

        .sidebar-btn {
            background-color: #fff;
            border: 2px solid #E9E1D3;
            border-radius: 8px;
            padding: 12px 20px;
            cursor: pointer;
            font-size: 16px;
            text-align: left;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            gap: 10px;
            width: 100%;
        }

        .sidebar-btn:hover {
            background-color: #F8F5F0;
            border-color: #4A5D50;
        }

        .sidebar-btn.danger {
            border-color: #ff4b4b;
            color: #ff4b4b;
        }

        .sidebar-btn.danger:hover {
            background-color: #fff5f5;
        }

        .overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 999;
            display: none;
        }

        .overlay.active {
            display: block;
        }

        .container {
            flex: 1;
            max-width: 1200px;
            width: 100%;
            margin: 0 auto;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }

        .custom-banner {
            background: linear-gradient(135deg, #2D3E33 0%, #4A5D50 100%);
            color: #F8F5F0;
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }

        .banner-text h2 {
            color: #F8F5F0;
            font-family: 'Georgia', serif;
            font-size: 36px;
            margin: 0;
        }

        .banner-text p {
            color: #C2CDC5;
            font-size: 18px;
            margin-top: 10px;
        }

        .banner-icon {
            font-size: 60px;
            opacity: 0.8;
        }

        .cards-wrapper {
            position: relative;
            overflow: hidden;
            margin-bottom: 30px;
        }

        .cards-container {
            display: flex;
            gap: 20px;
            transition: transform 0.3s ease-out;
        }

        .card {
            background-color: #EFE9DE;
            border-radius: 15px;
            padding: 30px;
            min-height: 220px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            position: relative;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.12);
        }

        .card-icon {
            font-size: 35px;
            position: absolute;
            top: 20px;
            right: 20px;
        }

        .card-title {
            font-size: 20px;
            font-weight: 600;
            color: #2D3E33;
            line-height: 1.3;
            font-family: 'Georgia', serif;
            margin-top: auto;
            max-width: 80%;
        }

        @media (min-width: 769px) {
            .cards-container {
                display: grid;
                grid-template-columns: repeat(3, 1fr);
            }

            .card {
                flex: none;
                width: 100%;
            }

            .nav-buttons, .dots {
                display: none;
            }
        }

        @media (max-width: 768px) {
            .custom-banner {
                padding: 30px 20px;
            }

            .banner-text h2 {
                font-size: 28px;
            }

            .banner-text p {
                font-size: 16px;
            }

            .cards-wrapper {
                padding: 0 20px;
            }

            .cards-container {
                gap: 20px;
            }

            .card {
                flex: 0 0 calc(100vw - 40px);
            }

            .nav-buttons {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-top: 20px;
                padding: 0 20px;
            }

            .nav-btn {
                background-color: #EFE9DE;
                border: 2px solid #4A5D50;
                border-radius: 12px;
                width: 50px;
                height: 50px;
                font-size: 24px;
                cursor: pointer;
                display: flex;
                align-items: center;
                justify-content: center;
                color: #2D3E33;
                transition: all 0.2s;
            }

            .nav-btn:hover {
                background-color: #E9E1D3;
            }

            .dots {
                display: flex;
                justify-content: center;
                gap: 8px;
                margin-top: 15px;
            }

            .dot {
                width: 8px;
                height: 8px;
                border-radius: 50%;
                background-color: #d4cfc4;
                transition: all 0.3s ease;
                cursor: pointer;
            }

            .dot.active {
                background-color: #4A5D50;
                width: 24px;
                border-radius: 4px;
            }
        }

        .chat-section {
            flex: 1;
            display: flex;
            flex-direction: column;
            background: white;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            max-height: 500px;
        }

        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            margin-bottom: 20px;
        }

        .message {
            margin-bottom: 15px;
            padding: 12px 16px;
            border-radius: 12px;
            max-width: 80%;
            line-height: 1.5;
        }

        .user-message {
            background-color: #E3F2FD;
            margin-left: auto;
            text-align: right;
        }

        .assistant-message {
            background-color: #F5F5F5;
            margin-right: auto;
        }

        .message-label {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 12px;
            color: #666;
        }

        .message-content {
            line-height: 1.6;
        }

        .message-content strong {
            font-weight: 600;
            color: #2D3E33;
        }

        .message-content ul, .message-content ol {
            margin: 10px 0;
            padding-left: 20px;
        }

        .message-content li {
            margin: 5px 0;
        }

        .thinking {
            background-color: #FFF3E0;
            padding: 12px 16px;
            border-radius: 12px;
            display: inline-block;
            font-style: italic;
            color: #666;
            animation: pulse 1.5s ease-in-out infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .chat-input-container {
            position: sticky;
            bottom: 0;
            background: white;
            padding: 20px;
            border-top: 1px solid #eee;
        }

        .chat-input-wrapper {
            display: flex;
            gap: 10px;
            max-width: 1200px;
            margin: 0 auto;
        }

        .chat-input {
            flex: 1;
            padding: 12px 20px;
            border: 2px solid #E9E1D3;
            border-radius: 25px;
            font-size: 16px;
            outline: none;
            transition: border-color 0.2s;
        }

        .chat-input:focus {
            border-color: #4A5D50;
        }

        .send-btn {
            background: linear-gradient(135deg, #2D3E33 0%, #4A5D50 100%);
            color: white;
            border: none;
            border-radius: 25px;
            padding: 12px 30px;
            font-size: 16px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .send-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .send-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="overlay" id="overlay"></div>

    <div class="sidebar" id="sidebar">
        <div class="sidebar-header">
            <h2>Settings</h2>
            <button class="close-btn" id="closeSidebarBtn">‚úï</button>
        </div>
        <div class="sidebar-content">
            <button class="sidebar-btn danger" id="clearChatBtn">
                üóëÔ∏è Clear Chat Memory
            </button>
            <div style="margin-top: 20px; padding: 15px; background-color: #F8F5F0; border-radius: 8px;">
                <p style="color: #666; font-size: 14px; margin: 0;">
                    This assistant uses the latest GPT-5 model via Replit AI Integrations.
                </p>
            </div>
        </div>
    </div>

    <div class="header">
        <div class="header-left">
            <h1>üí¨ AI Chat Assistant</h1>
            <p>A helpful assistant with memory of our conversation</p>
        </div>
        <div class="header-right">
            <button class="menu-btn" id="menuBtn">‚ò∞</button>
        </div>
    </div>

    <div class="container">
        <div id="cardsSection">
            <div class="custom-banner">
                <div class="banner-text">
                    <h2>Hello, Friend</h2>
                    <p>How can I help you move forward today?</p>
                </div>
                <div class="banner-icon">‚ú®</div>
            </div>

            <div class="cards-wrapper">
                <div class="cards-container" id="cardsContainer">
                    <div class="card" data-index="0">
                        <div class="card-icon">üöÄ</div>
                        <div class="card-title">Start a new project</div>
                    </div>
                    <div class="card" data-index="1">
                        <div class="card-icon">üí°</div>
                        <div class="card-title">Level up your career</div>
                    </div>
                    <div class="card" data-index="2">
                        <div class="card-icon">üõ†Ô∏è</div>
                        <div class="card-title">Fix some broken code</div>
                    </div>
                </div>
            </div>

            <div class="nav-buttons">
                <button class="nav-btn" id="prevBtn">‚óÄ</button>
                <button class="nav-btn" id="nextBtn">‚ñ∂</button>
            </div>

            <div class="dots" id="dots">
                <div class="dot active" data-index="0"></div>
                <div class="dot" data-index="1"></div>
                <div class="dot" data-index="2"></div>
            </div>
        </div>

        <div class="chat-section" id="chatSection">
            <div class="chat-messages" id="chatMessages"></div>
        </div>
    </div>

    <div class="chat-input-container">
        <div class="chat-input-wrapper">
            <input 
                type="text" 
                class="chat-input" 
                id="chatInput" 
                placeholder="How can I help you today?"
            >
            <button class="send-btn" id="sendBtn">Send</button>
        </div>
    </div>

    <script>
        let currentSlide = 0;
        let chatStarted = false;
        let isThinking = false;

        const prompts = [
            {
                displayText: "I want to start a new project. Can you help me come up with ideas?",
                text: "I want ideas for a project, but don't suggest anything yet. First, ask me a series of specific questions to understand my situation properly. Ask them step by step, not all at once. Your questions should cover: my interests and problems I care about, my current skills and tools I know, my experience level (beginner/intermediate/advanced), how much time I can realistically give, whether the project is for learning, competition, portfolio, business, or fun, constraints like budget, team size, device, or platform. After I answer all the questions, analyze my responses and: suggest 3‚Äì5 project ideas that actually fit me, explain why each idea is suitable, mention the main challenges of each idea, recommend one best project to start with, outline clear next steps to begin (tech stack, first milestone, etc.). Avoid generic ideas. Be practical, specific, and honest."
            },
            {
                displayText: "I want career guidance. Can you help me explore my options?",
                text: "I want career guidance, but don't give advice immediately. First, ask me a series of clear and specific questions to understand me properly. Ask them step by step, not all at once. Your questions should cover: what I'm interested in and enjoy doing, what I'm good at and what skills I already have, what I dislike or want to avoid, what kind of work environment suits me, my education level and practical limitations, my long-term goals, income expectations, and lifestyle preferences. After you finish asking questions and I answer them, analyze my responses honestly and: suggest 3‚Äì5 realistic career options, explain why each option fits or doesn't fit me, point out any contradictions or unrealistic assumptions in my thinking, suggest concrete next steps for the best options. Be direct, practical, and honest. No motivational fluff."
            },
            {
                displayText: "I need help debugging some code. Can you assist me?",
                text: "I need help debugging some code, but don't jump to conclusions yet. First, ask me a sequence of focused questions to fully understand the problem. Ask them step by step, not all at once. Your questions should cover: the programming language and environment, what the code is supposed to do, what it is actually doing, exact error messages or unexpected behavior, where and when the problem occurs, what I've already tried. After you have enough information and I answer, then: identify the most likely root cause(s), explain the bug in simple terms, show the corrected code, explain why the fix works, suggest how to prevent this type of bug in the future. Be precise and technical. Don't guess. Don't oversimplify."
            }
        ];

        // Wait for page to load
        window.onload = function() {
            console.log('Page loaded, attaching events...');

            // Card clicks
            document.querySelectorAll('.card').forEach(card => {
                card.onclick = function() {
                    const idx = parseInt(this.getAttribute('data-index'));
                    console.log('Card clicked:', idx);
                    selectCard(idx);
                };
            });

            // Navigation
            const prevBtn = document.getElementById('prevBtn');
            const nextBtn = document.getElementById('nextBtn');
            if (prevBtn) prevBtn.onclick = prevSlide;
            if (nextBtn) nextBtn.onclick = nextSlide;

            // Dots
            document.querySelectorAll('.dot').forEach(dot => {
                dot.onclick = function() {
                    const idx = parseInt(this.getAttribute('data-index'));
                    goToSlide(idx);
                };
            });

            // Send button
            document.getElementById('sendBtn').onclick = sendMessage;

            // Input enter key
            document.getElementById('chatInput').onkeypress = function(e) {
                if (e.key === 'Enter') sendMessage();
            };

            // Menu
            document.getElementById('menuBtn').onclick = toggleSidebar;
            
            // Close sidebar
            document.getElementById('closeSidebarBtn').onclick = closeSidebar;
            
            // Clear chat
            document.getElementById('clearChatBtn').onclick = clearChat;
            
            // Overlay
            document.getElementById('overlay').onclick = closeSidebar;

            console.log('All events attached!');
        };

        function toggleSidebar() {
            document.getElementById('sidebar').classList.toggle('open');
            document.getElementById('overlay').classList.toggle('active');
        }

        function closeSidebar() {
            document.getElementById('sidebar').classList.remove('open');
            document.getElementById('overlay').classList.remove('active');
        }

        function updateDots() {
            document.querySelectorAll('.dot').forEach((dot, i) => {
                dot.classList.toggle('active', i === currentSlide);
            });
        }

        function goToSlide(index) {
            if (window.innerWidth <= 768) {
                currentSlide = index;
                const cardWidth = document.querySelector('.card').offsetWidth;
                const gap = 20;
                const offset = -(currentSlide * (cardWidth + gap));
                document.getElementById('cardsContainer').style.transform = `translateX(${offset}px)`;
                updateDots();
            }
        }

        function nextSlide() {
            currentSlide = (currentSlide + 1) % 3;
            goToSlide(currentSlide);
        }

        
        function prevSlide() {
            currentSlide = (currentSlide - 1 + 3) % 3;
            goToSlide(currentSlide);
        }

        function selectCard(index) {
            console.log('Selecting card:', index);
            chatStarted = true;
            document.getElementById('cardsSection').classList.add('hidden');
            
            addMessage('user', prompts[index].displayText);
            sendHiddenMessage(prompts[index].text);
        }

        function addMessage(role, content) {
            const chatMessages = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${role}-message`;
            
            const label = document.createElement('div');
            label.className = 'message-label';
            label.textContent = role === 'user' ? 'üë§ You' : 'ü§ñ AI Chat Assistant';
            
            const text = document.createElement('div');
            text.className = 'message-content';
            
            let formattedContent = content
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/^- (.+)$/gm, '<li>$1</li>')
                .replace(/^\d+\. (.+)$/gm, '<li>$1</li>')
                .replace(/\n/g, '<br>');
            
            formattedContent = formattedContent.replace(/(<li>.*?<\/li>)+/gs, match => {
                return '<ul>' + match + '</ul>';
            });
            
            text.innerHTML = formattedContent;
            
            messageDiv.appendChild(label);
            messageDiv.appendChild(text);
            chatMessages.appendChild(messageDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function showThinking() {
            const chatMessages = document.getElementById('chatMessages');
            const thinkingDiv = document.createElement('div');
            thinkingDiv.className = 'thinking';
            thinkingDiv.id = 'thinkingIndicator';
            thinkingDiv.textContent = 'Thinking...';
            chatMessages.appendChild(thinkingDiv);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }

        function removeThinking() {
            const thinking = document.getElementById('thinkingIndicator');
            if (thinking) thinking.remove();
        }

        async function sendHiddenMessage(message) {
            isThinking = true;
            document.getElementById('sendBtn').disabled = true;
            showThinking();

            try {
                const response = await fetch('/send_message', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({message: message})
                });

                const data = await response.json();
                removeThinking();

                if (data.error) {
                    addMessage('assistant', 'Error: ' + data.error);
                } else {
                    addMessage('assistant', data.response);
                }
            } catch (error) {
                removeThinking();
                addMessage('assistant', 'Error: Failed to get response');
                console.error(error);
            }

            isThinking = false;
            document.getElementById('sendBtn').disabled = false;
        }

        async function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();

            if (!message || isThinking) return;

            chatStarted = true;
            document.getElementById('cardsSection').classList.add('hidden');

            addMessage('user', message);
            input.value = '';

            isThinking = true;
            document.getElementById('sendBtn').disabled = true;
            showThinking();

            try {
                const response = await fetch('/send_message', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({message: message})
                });

                const data = await response.json();
                removeThinking();

                if (data.error) {
                    addMessage('assistant', 'Error: ' + data.error);
                } else {
                    addMessage('assistant', data.response);
                }
            } catch (error) {
                removeThinking();
                addMessage('assistant', 'Error: Failed to get response');
                console.error(error);
            }

            isThinking = false;
            document.getElementById('sendBtn').disabled = false;
        }

        async function clearChat() {
            try {
                await fetch('/clear_chat', {method: 'POST'});
                document.getElementById('chatMessages').innerHTML = '';
                chatStarted = false;
                document.getElementById('cardsSection').classList.remove('hidden');
                currentSlide = 0;
                goToSlide(0);
                closeSidebar();
            } catch (error) {
                console.error('Error clearing chat:', error);
            }
        }

        let touchStartX = 0;
        let touchEndX = 0;

        const cardsContainer = document.getElementById('cardsContainer');
        cardsContainer.addEventListener('touchstart', e => {
            touchStartX = e.changedTouches[0].screenX;
        });

        cardsContainer.addEventListener('touchend', e => {
            touchEndX = e.changedTouches[0].screenX;
            const diff = touchStartX - touchEndX;
            if (window.innerWidth <= 768 && Math.abs(diff) > 50) {
                if (diff > 0) nextSlide();
                else prevSlide();
            }
        });
    </script>
</body>
</html>
```